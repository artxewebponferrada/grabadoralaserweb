---
import Layout from '../layouts/Layout.astro';
import ProductCard from '../components/ProductCard.astro';
import CategoryCard from '../components/CategoryCard.astro';
import BlogCard from '../components/BlogCard.astro';
import BrandCard from '../components/BrandCard.astro';
import FaqSection from '../components/faq/FaqSection.astro';
import { 
  getPublishedProducts, 
  getPublishedArticles, 
  getBrandsWithProductCount,
  getAuthorById 
} from '../utils/dataProcessing';
import data from '../data';

// Get processed data - limit to 9 items
const publishedProducts = getPublishedProducts().slice(0, 9);
const publishedArticles = getPublishedArticles(3);
const brandsWithProductCount = getBrandsWithProductCount(3);

// Get first 9 categories
const categories = data.categories.slice(0, 9);

// Process articles with author data
const articlesWithAuthors = publishedArticles.map(article => {
  const author = getAuthorById(article.author);
  return {
    ...article,
    author: author ? {
      name: author.name,
      avatar: author.avatar
    } : {
      name: 'Unknown Author',
      avatar: '/images/default-avatar.jpg'
    }
  };
});

// FAQ data
const homeFaqs = {
  title: "Preguntas Frecuentes sobre Grabadores Láser",
  questions: [
    {
      question: "¿Qué es un grabador láser?",
      answer: "Un grabador láser es una máquina que utiliza tecnología láser para grabar o cortar materiales con alta precisión. Es ideal para crear diseños personalizados en madera, acrílico, cuero y otros materiales."
    },
    {
      question: "¿Qué puedo hacer con un grabador láser?",
      answer: "Con un grabador láser puedes crear señalética, personalizar regalos, fabricar joyería, hacer decoración para el hogar, crear productos personalizados para vender, y mucho más."
    },
    {
      question: "¿Qué debo considerar al comprar un grabador láser?",
      answer: "Los factores principales son: potencia del láser, área de trabajo, materiales compatibles, software incluido, medidas de seguridad y tu presupuesto."
    }
  ]
};

// Schema data
const schema = {
  "@context": "https://schema.org",
  "@type": "WebSite",
  "name": "Laser Engraver Guide",
  "url": "https://laserengraverguide.com",
  "description": "Guía experta de grabadores láser: comparativas, reviews y consejos para elegir el mejor grabador láser.",
  "potentialAction": {
    "@type": "SearchAction",
    "target": "https://laserengraverguide.com/search?q={search_term_string}",
    "query-input": "required name=search_term_string"
  }
};
---

<Layout>
  <script type="application/ld+json" set:html={JSON.stringify(schema)} />

  <!-- Hero Section -->
  <section class="relative overflow-hidden bg-gradient-to-br from-primary-600 to-primary-800">
    <div class="absolute inset-0">
      <div class="absolute inset-0 bg-gradient-to-br from-primary-600/90 to-primary-800/90"></div>
      <div class="absolute inset-0 bg-[url('/images/hero-pattern.svg')] opacity-10"></div>
    </div>
    <div class="relative max-w-7xl mx-auto py-24 px-4 sm:px-6 lg:px-8">
      <div class="text-center">
        <h1 class="text-4xl font-extrabold tracking-tight text-white sm:text-5xl md:text-6xl">
          Encuentra tu <span class="text-primary-200">Grabador Láser</span> Ideal
        </h1>
        <p class="mt-6 max-w-2xl mx-auto text-xl text-primary-100">
          Reviews expertos, comparativas y guías para ayudarte a elegir el mejor grabador láser para tus necesidades.
        </p>
        <div class="mt-10 flex justify-center gap-4">
          <a
            href="/categories/"
            class="inline-flex items-center px-6 py-3 border border-transparent text-base font-medium rounded-full text-primary-700 bg-white hover:bg-primary-50 transition-colors duration-300"
          >
            Ver Categorías
          </a>
          <a
            href="/blog/"
            class="inline-flex items-center px-6 py-3 border border-white text-base font-medium rounded-full text-white hover:bg-primary-700/50 transition-colors duration-300"
          >
            Leer Blog
          </a>
        </div>
      </div>
    </div>
  </section>

  <!-- Featured Products -->
  <section class="bg-gray-50 py-16">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
      <header class="text-center mb-12">
        <h2 class="text-3xl font-extrabold tracking-tight text-gray-900 sm:text-4xl">
          Grabadores Láser Destacados
        </h2>
        <p class="mt-4 text-xl text-gray-600">
          Descubre nuestra selección de los mejores grabadores láser del mercado
        </p>
      </header>
      <div class="grid gap-8 md:grid-cols-2 lg:grid-cols-3">
        {publishedProducts.map((product) => (
          <ProductCard {...product} />
        ))}
      </div>
      <div class="text-center mt-12">
        <a
          href="/buscador/"
          class="inline-flex items-center px-6 py-3 border border-transparent text-base font-medium rounded-full text-white bg-primary-600 hover:bg-primary-700 transition-colors"
        >
          Ver todos los grabadores láser
          <svg class="ml-2 w-5 h-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M14 5l7 7m0 0l-7 7m7-7H3" />
          </svg>
        </a>
      </div>
    </div>
  </section>

  <!-- Why Choose Us Section -->
  <section class="bg-white py-16">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
      <header class="text-center mb-12">
        <h2 class="text-3xl font-extrabold text-gray-900">
          ¿Por qué elegirnos? 🎯
        </h2>
        <p class="mt-4 text-xl text-gray-600">
          Tu guía experta en el mundo del grabado láser
        </p>
      </header>
      <div class="grid gap-8 md:grid-cols-3">
        <div class="text-center p-6">
          <span class="text-4xl mb-4 block">🔍</span>
          <h3 class="text-xl font-bold text-gray-900 mb-2">Reviews Detalladas</h3>
          <p class="text-gray-600">Analizamos cada grabador láser a fondo para ofrecerte información precisa y objetiva</p>
        </div>
        <div class="text-center p-6">
          <span class="text-4xl mb-4 block">💡</span>
          <h3 class="text-xl font-bold text-gray-900 mb-2">Consejos Expertos</h3>
          <p class="text-gray-600">Te ayudamos a elegir el grabador perfecto para tus necesidades específicas</p>
        </div>
        <div class="text-center p-6">
          <span class="text-4xl mb-4 block">🔄</span>
          <h3 class="text-xl font-bold text-gray-900 mb-2">Actualización Constante</h3>
          <p class="text-gray-600">Mantenemos nuestra información al día con las últimas novedades del mercado</p>
        </div>
      </div>
    </div>
  </section>

  <!-- Categories -->
  <section class="bg-gray-50 py-16">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
      <header class="text-center mb-12">
        <h2 class="text-3xl font-extrabold text-gray-900">
          Explora por Categorías
        </h2>
        <p class="mt-4 text-xl text-gray-600">
          Encuentra el grabador láser perfecto para tus necesidades
        </p>
      </header>
      <div class="grid gap-8 md:grid-cols-2 lg:grid-cols-3">
        {categories.map((category) => (
          <CategoryCard {...category} />
        ))}
      </div>
      <div class="text-center mt-12">
        <a
          href="/categories/"
          class="inline-flex items-center px-6 py-3 border border-transparent text-base font-medium rounded-full text-white bg-primary-600 hover:bg-primary-700 transition-colors"
        >
          Ver todas las categorías
          <svg class="ml-2 w-5 h-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M14 5l7 7m0 0l-7 7m7-7H3" />
          </svg>
        </a>
      </div>
    </div>
  </section>

  <!-- Benefits Section -->
  <section class="bg-white py-16">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
      <header class="text-center mb-12">
        <h2 class="text-3xl font-extrabold text-gray-900">
          Beneficios de las máquinas de grabado láser
        </h2>
        <p class="mt-4 text-xl text-gray-600">
          Descubre las ventajas de utilizar tecnología láser
        </p>
      </header>
      <div class="grid gap-8 md:grid-cols-2">
        <div class="bg-gray-50 rounded-2xl p-8">
          <img
            src="/imagenes/grabadora-laser.jpg"
            alt="Grabadora láser"
            class="w-full h-48 object-cover rounded-xl mb-6"
          />
          <h3 class="text-xl font-bold text-gray-900 mb-4">Alta Precisión</h3>
          <p class="text-gray-600">
            Los grabadores láser ofrecen una precisión incomparable, permitiendo crear diseños detallados y complejos con exactitud milimétrica.
          </p>
        </div>
        <div class="bg-gray-50 rounded-2xl p-8">
          <img
            src="/imagenes/grabador-laser.jpg"
            alt="Grabador láser"
            class="w-full h-48 object-cover rounded-xl mb-6"
          />
          <h3 class="text-xl font-bold text-gray-900 mb-4">Versatilidad</h3>
          <p class="text-gray-600">
            Trabaja con múltiples materiales: desde madera y acrílico hasta cuero y metal, las posibilidades son infinitas.
          </p>
        </div>
      </div>
    </div>
  </section>

  <!-- Latest Blog Posts -->
  <section class="bg-gray-50 py-16">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
      <header class="text-center mb-12">
        <h2 class="text-3xl font-extrabold text-gray-900">
          Artículos sobre grabado y corte laser
        </h2>
        <p class="mt-4 text-xl text-gray-600">
          Mantente al día con las últimas tendencias y consejos en grabado láser
        </p>
      </header>
      <div class="grid gap-8 md:grid-cols-2 lg:grid-cols-3">
        {articlesWithAuthors.map((article) => (
          <BlogCard {...article} />
        ))}
      </div>
    </div>
  </section>

  <!-- Application Areas -->
  <section class="bg-white py-16">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
      <header class="text-center mb-12">
        <h2 class="text-3xl font-extrabold text-gray-900">
          Usos de las grabadoras láser
        </h2>
        <p class="mt-4 text-xl text-gray-600">
          Explora las infinitas posibilidades del grabado láser
        </p>
      </header>
      <div class="grid gap-6 md:grid-cols-4">
        <div class="bg-gray-50 rounded-xl p-6 text-center">
          <span class="text-3xl mb-3 block">🎁</span>
          <h3 class="font-semibold text-gray-900">Regalos Personalizados</h3>
        </div>
        <div class="bg-gray-50 rounded-xl p-6 text-center">
          <span class="text-3xl mb-3 block">🏢</span>
          <h3 class="font-semibold text-gray-900">Señalética Comercial</h3>
        </div>
        <div class="bg-gray-50 rounded-xl p-6 text-center">
          <span class="text-3xl mb-3 block">💍</span>
          <h3 class="font-semibold text-gray-900">Joyería</h3>
        </div>
        <div class="bg-gray-50 rounded-xl p-6 text-center">
          <span class="text-3xl mb-3 block">🏠</span>
          <h3 class="font-semibold text-gray-900">Decoración</h3>
        </div>
      </div>
    </div>
  </section>

  <!-- FAQs Section -->
  <section class="bg-gray-50 py-16">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
      <FaqSection {...homeFaqs} />
      <div class="text-center mt-8">
        <a
          href="/faqs/"
          class="inline-flex items-center px-6 py-3 border border-transparent text-base font-medium rounded-full text-white bg-primary-600 hover:bg-primary-700 transition-colors"
        >
          Ver Todas las Preguntas Frecuentes
        </a>
      </div>
    </div>
  </section>

  <!-- CTA Section -->
  <section class="bg-primary-600">
    <div class="max-w-7xl mx-auto py-16 px-4 sm:px-6 lg:px-8">
      <div class="text-center">
        <h2 class="text-3xl font-extrabold text-white mb-4">
          ¿Listo para empezar con el grabado láser?
        </h2>
        <p class="text-xl text-primary-100 mb-8">
          Descubre nuestras guías y encuentra el grabador láser perfecto para ti
        </p>
        <div class="flex justify-center gap-4">
          <a
            href="/categories/"
            class="inline-flex items-center px-6 py-3 border border-transparent text-base font-medium rounded-full text-primary-700 bg-white hover:bg-primary-50 transition-colors"
          >
            Explorar Grabadores
          </a>
          <a
            href="/blog/"
            class="inline-flex items-center px-6 py-3 border border-white text-base font-medium rounded-full text-white hover:bg-primary-700/50 transition-colors"
          >
            Leer Guías
          </a>
        </div>
      </div>
    </div>
  </section>
</Layout>