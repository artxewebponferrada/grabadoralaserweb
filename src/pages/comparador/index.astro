---
// src/pages/comparador/index.astro
import Layout from '../../layouts/Layout.astro';
import brandsData from '../../data/brands.json';
import productsData from '../../data/products.json';

// --- 1. TOP 3 MODELOS CONCRETOS (Hardcoded) ---
// Elegimos 3 modelos específicos para el podio principal
const topModel1Id = "xtool-p2-55w"; // Ganador Global / Profesional
const topModel2Id = "sculpfun-s30-pro"; // Mejor Calidad/Precio
const topModel3Id = "ortur-laser-master-3-20w"; // Mejor Fiabilidad

const topModel1 = productsData.products.find(p => p.id === topModel1Id);
const topModel2 = productsData.products.find(p => p.id === topModel2Id);
const topModel3 = productsData.products.find(p => p.id === topModel3Id);

// --- 2. TOP 5 MARCAS (Hardcoded) ---
// Elegimos las 5 mejores marcas para recomendar
const topBrand1Id = "xtool";
const topBrand2Id = "sculpfun";
const topBrand3Id = "ortur";
const topBrand4Id = "atomstack";
const topBrand5Id = "commarker"; // Especialista

const topBrandsList = [
  { id: topBrand1Id, reason: "Líder indiscutible en innovación, software y seguridad. El 'Apple' del láser." },
  { id: topBrand2Id, reason: "La mejor relación calidad-precio para empezar sin gastar una fortuna." },
  { id: topBrand3Id, reason: "Pioneros en diodo. Máquinas robustas, rápidas y muy fiables a largo plazo." },
  { id: topBrand4Id, reason: "Potencia bruta. Ofrecen los módulos de diodo más potentes para cortar madera gruesa." },
  { id: topBrand5Id, reason: "La referencia para grabado en metal y plásticos con sus láseres de fibra y UV." }
].map(item => {
  const brand = brandsData.brands.find(b => b.id === item.id);
  return { ...brand, reason: item.reason };
});

// --- 3. MEJOR PARA... (Hardcoded por uso) ---
// Seleccionamos productos específicos para cada categoría
const bestForBeginnersId = "creality-falcon-5w";
const bestForWoodId = "ikier-k1-pro-max-24w"; // Potencia y autoenfoque
const bestForMetalId = "commarker-b4"; // Fibra
const bestForBusinessId = "omtech-100w"; // CO2 potente
const bestPortableId = "laserpecker-4"; // Dual laser portátil

const bestForList = [
  { id: bestForBeginnersId, title: "Mejor para Novatos", desc: "Fácil de montar, seguro y con potencia suficiente para aprender." },
  { id: bestForWoodId, title: "Mejor para Cortar Madera", desc: "Potencia de diodo extrema y asistencia de aire para cortes limpios." },
  { id: bestForMetalId, title: "Mejor para Grabar Metal", desc: "Láser de fibra real para marcaje profundo y rápido en metales." },
  { id: bestForBusinessId, title: "Mejor para Negocios", desc: "Gran formato, CO2 de 100W y velocidad industrial para producción." },
  { id: bestPortableId, title: "Mejor Portátil", desc: "Llévalo a ferias o eventos. Graba en cualquier lugar con calidad." }
].map(item => {
  const product = productsData.products.find(p => p.id === item.id);
  return { ...product, customTitle: item.title, customDesc: item.desc };
});

---

<Layout
  title="Comparador de Grabadoras Láser: Top Modelos y Marcas 2025"
  description="Análisis definitivo. Los 3 mejores modelos del año, las 5 mejores marcas y la guía de compra por uso (novatos, metal, negocio). Elegido por expertos."
>
  <main class="bg-slate-50 min-h-screen font-sans text-slate-800">
    
    {/* HERO */}
    <div class="bg-slate-900 text-white pt-20 pb-24 px-4 text-center">
      <h1 class="text-4xl md:text-6xl font-extrabold mb-6">
        Las Mejores <span class="text-blue-400">Grabadoras Láser</span> de 2025
      </h1>
      <p class="text-xl text-slate-300 max-w-3xl mx-auto">
        He seleccionado manualmente las máquinas que realmente valen la pena. 
        Sin rellenos. Aquí tienes lo mejor del mercado clasificado por rendimiento, marca y uso.
      </p>
    </div>

    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 -mt-16 relative z-10">

      {/* --- SECCIÓN 1: TOP 3 MODELOS (PODIO) --- */}
      <section class="mb-24">
        <h2 class="text-3xl font-bold text-center mb-10 sr-only">Top 3 Modelos Recomendados</h2>
        <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
          
          {/* PUESTO 2: CALIDAD/PRECIO (SCULPFUN S30 PRO) */}
          <div class="bg-white rounded-2xl shadow-lg overflow-hidden border border-slate-200 flex flex-col order-2 lg:order-1 lg:mt-8">
            <div class="bg-green-600 py-2 text-center text-white font-bold uppercase text-sm">Mejor Calidad / Precio</div>
            <div class="p-6 flex-1 flex flex-col">
              <img src={topModel2.mainImage} alt={topModel2.title} class="w-full h-48 object-contain mb-4" />
              <h3 class="text-xl font-bold text-slate-900 mb-2 line-clamp-2">{topModel2.title}</h3>
              <div class="flex text-yellow-400 text-sm mb-4">★★★★☆ (4.1)</div>
              <p class="text-sm text-slate-600 mb-6 flex-1">
                {topModel2.shortDescription}
              </p>
              <div class="space-y-3">
                <a href={`/productos/${topModel2.slug}`} class="block w-full py-2 text-center border-2 border-slate-200 rounded-lg font-bold text-slate-700 hover:border-green-600 hover:text-green-600 transition-colors">
                  Leer Análisis
                </a>
                <a href={topModel2.affiliateUrl} target="_blank" rel="nofollow" class="block w-full py-3 text-center bg-green-600 text-white rounded-lg font-bold hover:bg-green-700 transition-colors shadow-md">
                  Ver Precio en Amazon
                </a>
              </div>
            </div>
          </div>

          {/* PUESTO 1: GANADOR GLOBAL (XTOOL P2) */}
          <div class="bg-white rounded-2xl shadow-2xl overflow-hidden border-2 border-blue-600 flex flex-col order-1 lg:order-2 transform scale-105 z-10 relative">
            <div class="absolute top-0 right-0 bg-blue-600 text-white px-3 py-1 text-xs font-bold rounded-bl-lg">TOP 1</div>
            <div class="bg-slate-900 py-3 text-center text-white font-bold uppercase text-base">La Mejor Opción Profesional</div>
            <div class="p-8 flex-1 flex flex-col">
              <img src={topModel1.mainImage} alt={topModel1.title} class="w-full h-56 object-contain mb-6" />
              <h3 class="text-2xl font-black text-slate-900 mb-2 line-clamp-2">{topModel1.title}</h3>
              <div class="flex text-yellow-400 text-base mb-4">★★★★★ (4.8)</div>
              <p class="text-base text-slate-600 mb-8 flex-1">
                {topModel1.shortDescription}
              </p>
              <div class="space-y-4">
                <a href={`/productos/${topModel1.slug}`} class="block w-full py-3 text-center border-2 border-slate-200 rounded-xl font-bold text-slate-700 hover:border-blue-600 hover:text-blue-600 transition-colors">
                  Leer Análisis Completo
                </a>
                <a href={topModel1.affiliateUrl} target="_blank" rel="nofollow" class="block w-full py-4 text-center bg-blue-600 text-white rounded-xl font-bold text-lg hover:bg-blue-700 transition-colors shadow-lg">
                  Comprar al Mejor Precio
                </a>
              </div>
            </div>
          </div>

          {/* PUESTO 3: FIABILIDAD (ORTUR LM3) */}
          <div class="bg-white rounded-2xl shadow-lg overflow-hidden border border-slate-200 flex flex-col order-3 lg:mt-8">
            <div class="bg-slate-600 py-2 text-center text-white font-bold uppercase text-sm">Mayor Fiabilidad</div>
            <div class="p-6 flex-1 flex flex-col">
              <img src={topModel3.mainImage} alt={topModel3.title} class="w-full h-48 object-contain mb-4" />
              <h3 class="text-xl font-bold text-slate-900 mb-2 line-clamp-2">{topModel3.title}</h3>
              <div class="flex text-yellow-400 text-sm mb-4">★★★★☆ (3.9)</div>
              <p class="text-sm text-slate-600 mb-6 flex-1">
                {topModel3.shortDescription}
              </p>
              <div class="space-y-3">
                <a href={`/productos/${topModel3.slug}`} class="block w-full py-2 text-center border-2 border-slate-200 rounded-lg font-bold text-slate-700 hover:border-slate-600 hover:text-slate-800 transition-colors">
                  Leer Análisis
                </a>
                <a href={topModel3.affiliateUrl} target="_blank" rel="nofollow" class="block w-full py-3 text-center bg-slate-700 text-white rounded-lg font-bold hover:bg-slate-800 transition-colors shadow-md">
                  Ver Precio en Amazon
                </a>
              </div>
            </div>
          </div>

        </div>
      </section>

      {/* --- SECCIÓN 2: TOP 5 MARCAS RECOMENDADAS --- */}
      <section class="mb-24">
        <div class="flex items-center justify-center mb-12">
          <h2 class="text-3xl font-bold text-slate-900">Las 5 Mejores Marcas del Mercado</h2>
        </div>
        
        <div class="grid gap-6">
          {topBrandsList.map((brand, index) => (
            <div class="bg-white rounded-xl p-6 shadow-sm border border-slate-200 flex flex-col md:flex-row items-center gap-6 hover:shadow-md transition-shadow">
              <div class="flex-shrink-0 flex items-center justify-center w-24 h-24 bg-slate-50 rounded-lg p-2 border border-slate-100">
                <img src={brand.logo} alt={brand.name} class="max-w-full max-h-full object-contain mix-blend-multiply" />
              </div>
              
              <div class="flex-1 text-center md:text-left">
                <div class="flex items-center justify-center md:justify-start gap-3 mb-2">
                  <span class="text-4xl font-black text-slate-200">#{index + 1}</span>
                  <h3 class="text-2xl font-bold text-slate-900">{brand.name}</h3>
                  <div class="flex text-yellow-400 text-sm">{"★".repeat(Math.floor(brand.rating))}</div>
                </div>
                <p class="text-slate-700 font-medium mb-2">
                  <span class="text-blue-600 font-bold">¿Por qué la recomiendo?</span> {brand.reason}
                </p>
                <p class="text-sm text-slate-500 line-clamp-2">{brand.description}</p>
              </div>

              <div class="flex-shrink-0 w-full md:w-auto flex flex-col gap-2">
                <a href={`/marcas/${brand.slug}`} class="px-6 py-2 bg-slate-900 text-white font-bold rounded-lg hover:bg-blue-600 transition-colors text-center text-sm">
                  Ver Análisis de Marca
                </a>
                <a href={brand.amazonUrl} target="_blank" rel="nofollow" class="px-6 py-2 border border-slate-300 text-slate-600 font-bold rounded-lg hover:bg-yellow-400 hover:text-yellow-900 hover:border-yellow-400 transition-colors text-center text-sm">
                  Ver Tienda Oficial
                </a>
              </div>
            </div>
          ))}
        </div>
      </section>

      {/* --- SECCIÓN 3: MEJOR GRABADORA PARA... (POR TIPO DE USUARIO) --- */}
      <section class="mb-20">
        <h2 class="text-3xl font-bold text-slate-900 text-center mb-12">¿Cuál es la mejor para ti?</h2>
        
        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
          {bestForList.map((item) => (
            <div class="bg-white rounded-xl border border-slate-200 overflow-hidden hover:shadow-lg transition-shadow flex flex-col">
              <div class="h-2 bg-blue-500 w-full"></div>
              <div class="p-6 flex-1 flex flex-col">
                <h3 class="text-lg font-bold text-blue-900 mb-1 uppercase tracking-wider">{item.customTitle}</h3>
                <h4 class="text-xl font-bold text-slate-900 mb-4">{item.title}</h4>
                
                <div class="relative w-full h-40 mb-4 bg-slate-50 rounded-lg p-2">
                  <img src={item.mainImage} alt={item.title} class="w-full h-full object-contain mix-blend-multiply" />
                </div>
                
                <p class="text-sm text-slate-600 mb-6 flex-1">
                  {item.customDesc}
                </p>

                <div class="grid grid-cols-2 gap-3 mt-auto">
                  <a href={`/productos/${item.slug}`} class="py-2 text-center text-sm font-bold text-slate-600 bg-slate-100 rounded hover:bg-slate-200 transition-colors">
                    Leer Review
                  </a>
                  <a href={item.affiliateUrl} target="_blank" rel="nofollow" class="py-2 text-center text-sm font-bold text-white bg-blue-600 rounded hover:bg-blue-700 transition-colors">
                    Ver Precio
                  </a>
                </div>
              </div>
            </div>
          ))}
        </div>
      </section>

    </div>
  </main>
</Layout>
