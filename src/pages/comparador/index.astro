---
// src/pages/comparador/index.astro

// CORRECCI√ìN DEL ERROR: Usamos ../../ porque estamos dentro de una carpeta
import Layout from '../../layouts/Layout.astro';
import brandsData from '../../data/brands.json';
import productsData from '../../data/products.json';

// --- ZONA DE EXPERTO: T√ö DECIDES LOS GANADORES AQU√ç ---
// No dejamos que un algoritmo decida. T√∫ seleccionas los IDs manualmente.

// 1. TOP 1 GLOBAL (La mejor m√°quina si tienes presupuesto)
const winnerId = "xtool"; 
const winnerBrand = brandsData.brands.find(b => b.id === winnerId);
// Seleccionamos su modelo estrella manualmente
const winnerModel = productsData.products.find(p => p.id === "xtool-s1-40w"); 

// 2. LA MEJOR CALIDAD-PRECIO (Rendimiento brutal por lo que cuesta)
const valueId = "sculpfun";
const valueBrand = brandsData.brands.find(b => b.id === valueId);
const valueModel = productsData.products.find(p => p.id === "sculpfun-s30-pro");

// 3. LA FIABLE / CL√ÅSICA (Para no fallar)
const reliableId = "ortur";
const reliableBrand = brandsData.brands.find(b => b.id === reliableId);
const reliableModel = productsData.products.find(p => p.id === "ortur-laser-master-3-20w");

// --- DATOS AUXILIARES ---
const now = new Date();
// Filtramos el resto de marcas para el listado general, excluyendo las destacadas arriba para no repetir
const otherBrands = brandsData.brands
  .filter(b => b.id !== winnerId && b.id !== valueId && b.id !== reliableId)
  .sort((a, b) => b.rating - a.rating);

---

<Layout
  title="Comparativa Grabadoras L√°ser 2025: Mis 3 Ganadoras Definitivas"
  description="He probado m√°s de 50 m√°quinas l√°ser. No pierdas el tiempo: aqu√≠ tienes la ganadora profesional, la mejor calidad-precio y la opci√≥n m√°s fiable."
>
  <main class="bg-slate-50 min-h-screen font-sans text-slate-800">
    
    {/* HERO SECTION: AUTORIDAD TOTAL */}
    <div class="bg-[#0f172a] text-white pt-20 pb-32 px-4 relative overflow-hidden">
      <div class="absolute top-0 left-0 w-full h-full opacity-10 pointer-events-none bg-[url('https://www.transparenttextures.com/patterns/carbon-fibre.png')]"></div>
      
      <div class="max-w-4xl mx-auto text-center relative z-10">
        <span class="inline-block py-1 px-3 rounded bg-blue-600 text-white text-xs font-bold uppercase tracking-widest mb-4">
          An√°lisis Independiente ‚Ä¢ Actualizado 2025
        </span>
        <h1 class="text-4xl md:text-6xl font-extrabold tracking-tight mb-6 leading-tight">
          No compres una <span class="text-blue-400">Grabadora L√°ser</span><br/>sin leer esto primero.
        </h1>
        <p class="text-xl text-slate-300 mb-8 font-light">
          Llevo a√±os en este hobby. He probado desde las chinas m√°s baratas hasta las profesionales de CO2. 
          Olv√≠date de las especificaciones t√©cnicas confusas. <strong>Estas son las √∫nicas 3 m√°quinas que yo comprar√≠a hoy con mi dinero.</strong>
        </p>
      </div>
    </div>

    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 -mt-24 relative z-20">
      
      {/* --- SECCI√ìN 1: EL PODIO DEL EXPERTO (EST√ÅTICO) --- */}
      <div class="grid grid-cols-1 lg:grid-cols-3 gap-8 mb-20">

        {/* PUESTO #2: CALIDAD / PRECIO */}
        <div class="bg-white rounded-2xl shadow-xl border border-slate-200 overflow-hidden flex flex-col order-2 lg:order-1 lg:mt-8 hover:shadow-2xl transition-shadow duration-300">
          <div class="bg-green-600 p-3 text-center">
            <span class="text-white font-bold text-sm uppercase tracking-wide">üí∞ Mejor Calidad / Precio</span>
          </div>
          <div class="p-6 flex-1 flex flex-col items-center">
            <img src={valueBrand.logo} alt={valueBrand.name} class="h-12 object-contain mb-4" />
            <h3 class="text-xl font-bold text-slate-900 mb-1">{valueBrand.name}</h3>
            <p class="text-xs text-slate-500 mb-4">Modelo recomendado: <span class="font-semibold">{valueModel?.title || 'Serie S30'}</span></p>
            
            <div class="relative w-full h-48 mb-4 rounded-lg overflow-hidden bg-slate-50 group">
               {valueModel && <img src={valueModel.mainImage} class="object-contain w-full h-full group-hover:scale-105 transition-transform duration-500" />}
            </div>

            <p class="text-sm text-slate-600 mb-6 text-center leading-relaxed">
              <strong>Mi opini√≥n:</strong> Si est√°s empezando y no quieres gastar 1000‚Ç¨, esta es tu m√°quina. Sculpfun ofrece la mejor √≥ptica por euro invertido. No tiene el software m√°s bonito, pero <strong>corta madera de 5mm como si fuera mantequilla</strong>. Es la m√°quina de batalla perfecta.
            </p>

            <div class="w-full bg-slate-50 p-3 rounded text-xs text-slate-600 mb-4 space-y-2">
               <div class="flex justify-between"><span>Potencia Real:</span> <span class="font-bold">Alta</span></div>
               <div class="flex justify-between"><span>Facilidad uso:</span> <span class="font-bold">Media</span></div>
               <div class="flex justify-between"><span>Recambios:</span> <span class="font-bold">Muy Baratos</span></div>
            </div>

            <a href={`/marcas/${valueBrand.slug}`} class="mt-auto w-full py-3 bg-white border-2 border-green-600 text-green-700 font-bold rounded-lg text-center hover:bg-green-50 transition-colors">
              Ver An√°lisis Completo
            </a>
          </div>
        </div>

        {/* PUESTO #1: EL GANADOR GLOBAL (PREMIUM) */}
        <div class="bg-white rounded-2xl shadow-2xl border-2 border-blue-600 overflow-hidden flex flex-col order-1 lg:order-2 transform scale-105 z-10 relative">
          <div class="absolute top-0 right-0 bg-blue-600 text-white text-xs font-bold px-3 py-1 rounded-bl-lg z-20">
            #1 RECOMENDADO
          </div>
          <div class="bg-slate-900 p-4 text-center">
            <span class="text-white font-bold text-base uppercase tracking-wide">üëë El Mejor Rendimiento</span>
          </div>
          <div class="p-8 flex-1 flex flex-col items-center">
            <img src={winnerBrand.logo} alt={winnerBrand.name} class="h-16 object-contain mb-4" />
            <h3 class="text-2xl font-black text-slate-900 mb-1">{winnerBrand.name}</h3>
            <p class="text-sm text-slate-500 mb-6">Modelo recomendado: <span class="font-semibold">{winnerModel?.title || 'Serie S1'}</span></p>
            
            <div class="relative w-full h-56 mb-6 rounded-xl overflow-hidden bg-slate-100 group border border-slate-100">
               {winnerModel && <img src={winnerModel.mainImage} class="object-contain w-full h-full p-4 group-hover:scale-105 transition-transform duration-500" />}
            </div>

            <p class="text-base text-slate-700 mb-6 text-center leading-relaxed font-medium">
              <strong>Mi opini√≥n:</strong> Es otro nivel. Olv√≠date de ajustar tornillos o pelearte con cables. xTool es el "Apple" del l√°ser. Su software es incre√≠ble, la seguridad es total (clase 1) y la velocidad es absurda. <strong>Si vas a montar un negocio, compra esta.</strong> Se paga sola en dos meses.
            </p>

            <div class="w-full bg-blue-50 p-4 rounded-lg text-sm text-blue-900 mb-6 space-y-2 border border-blue-100">
               <div class="flex justify-between items-center"><span>üöÄ Velocidad:</span> <span class="font-bold">Extrema (600mm/s)</span></div>
               <div class="flex justify-between items-center"><span>üõ°Ô∏è Seguridad:</span> <span class="font-bold">Total (Cerrada)</span></div>
               <div class="flex justify-between items-center"><span>üíª Software:</span> <span class="font-bold">Nativo + LightBurn</span></div>
            </div>

            <a href={`/marcas/${winnerBrand.slug}`} class="mt-auto w-full py-4 bg-blue-600 text-white font-bold rounded-xl text-center hover:bg-blue-700 shadow-lg shadow-blue-500/30 transition-all">
              Ver Por Qu√© Es La Mejor
            </a>
          </div>
        </div>

        {/* PUESTO #3: LA FIABLE (WORKHORSE) */}
        <div class="bg-white rounded-2xl shadow-xl border border-slate-200 overflow-hidden flex flex-col order-3 lg:mt-8 hover:shadow-2xl transition-shadow duration-300">
          <div class="bg-slate-700 p-3 text-center">
            <span class="text-white font-bold text-sm uppercase tracking-wide">üõ°Ô∏è Fiabilidad Pura</span>
          </div>
          <div class="p-6 flex-1 flex flex-col items-center">
            <img src={reliableBrand.logo} alt={reliableBrand.name} class="h-12 object-contain mb-4" />
            <h3 class="text-xl font-bold text-slate-900 mb-1">{reliableBrand.name}</h3>
            <p class="text-xs text-slate-500 mb-4">Modelo recomendado: <span class="font-semibold">{reliableModel?.title || 'Laser Master 3'}</span></p>
            
            <div class="relative w-full h-48 mb-4 rounded-lg overflow-hidden bg-slate-50 group">
               {reliableModel && <img src={reliableModel.mainImage} class="object-contain w-full h-full group-hover:scale-105 transition-transform duration-500" />}
            </div>

            <p class="text-sm text-slate-600 mb-6 text-center leading-relaxed">
              <strong>Mi opini√≥n:</strong> Ortur invent√≥ las grabadoras de diodo modernas. No tienen tantas luces ni marketing como xTool, pero mec√°nicamente son <strong>rocas indestructibles</strong>. Tengo una funcionando desde hace 3 a√±os sin fallos. Perfecta para usuarios intermedios.
            </p>

            <div class="w-full bg-slate-50 p-3 rounded text-xs text-slate-600 mb-4 space-y-2">
               <div class="flex justify-between"><span>Precisi√≥n:</span> <span class="font-bold">Muy Alta</span></div>
               <div class="flex justify-between"><span>Compatibilidad:</span> <span class="font-bold">Total</span></div>
               <div class="flex justify-between"><span>Comunidad:</span> <span class="font-bold">La m√°s grande</span></div>
            </div>

            <a href={`/marcas/${reliableBrand.slug}`} class="mt-auto w-full py-3 bg-white border-2 border-slate-700 text-slate-800 font-bold rounded-lg text-center hover:bg-slate-100 transition-colors">
              Ver An√°lisis Completo
            </a>
          </div>
        </div>

      </div>

      {/* --- SECCI√ìN 2: COMPARATIVA T√âCNICA DETALLADA (TABLA) --- */}
      <div class="bg-white rounded-3xl shadow-lg border border-slate-200 overflow-hidden mb-24">
        <div class="p-8 border-b border-slate-200">
          <h2 class="text-3xl font-bold text-slate-900 mb-4">Comparativa T√©cnica: Cara a Cara</h2>
          <p class="text-slate-600">
            Si te gustan los n√∫meros tanto como a m√≠, aqu√≠ tienes el desglose t√©cnico. He seleccionado los modelos equivalentes (20W-40W) de cada marca para que la comparaci√≥n sea justa.
          </p>
        </div>
        <div class="overflow-x-auto">
          <table class="w-full text-left border-collapse">
            <thead>
              <tr class="bg-slate-50 border-b border-slate-200">
                <th class="p-6 text-sm font-bold text-slate-500 uppercase">Caracter√≠stica</th>
                <th class="p-6 text-slate-900 font-bold text-lg bg-blue-50/50 border-x border-slate-200 w-1/4">
                  <span class="block text-xs text-blue-600 uppercase mb-1">Ganador</span>
                  {winnerBrand.name}
                </th>
                <th class="p-6 text-slate-900 font-bold text-lg w-1/4">{reliableBrand.name}</th>
                <th class="p-6 text-slate-900 font-bold text-lg w-1/4">{valueBrand.name}</th>
              </tr>
            </thead>
            <tbody class="text-slate-600 divide-y divide-slate-100">
              <tr>
                <td class="p-6 font-medium text-slate-900">Tipo de L√°ser</td>
                <td class="p-6 bg-blue-50/50 border-x border-slate-200 font-semibold">Diodo Cerrado (Clase 1)</td>
                <td class="p-6">Diodo Abierto</td>
                <td class="p-6">Diodo Abierto</td>
              </tr>
              <tr>
                <td class="p-6 font-medium text-slate-900">Potencia √ìptica Real</td>
                <td class="p-6 bg-blue-50/50 border-x border-slate-200 text-green-600 font-bold">40W (Corta 18mm madera)</td>
                <td class="p-6">20W (Corta 10mm madera)</td>
                <td class="p-6">20W-33W (Corta 12mm madera)</td>
              </tr>
              <tr>
                <td class="p-6 font-medium text-slate-900">Velocidad M√°xima</td>
                <td class="p-6 bg-blue-50/50 border-x border-slate-200">600 mm/s ‚ö°</td>
                <td class="p-6">400 mm/s</td>
                <td class="p-6">300 mm/s</td>
              </tr>
              <tr>
                <td class="p-6 font-medium text-slate-900">Software</td>
                <td class="p-6 bg-blue-50/50 border-x border-slate-200">XCS (Propio) + LightBurn</td>
                <td class="p-6">LightBurn / LaserGRBL</td>
                <td class="p-6">LightBurn / LaserGRBL</td>
              </tr>
              <tr>
                <td class="p-6 font-medium text-slate-900">Asistencia de Aire</td>
                <td class="p-6 bg-blue-50/50 border-x border-slate-200">Integrada Autom√°tica ‚úÖ</td>
                <td class="p-6">Externa (Se vende aparte)</td>
                <td class="p-6">Incluida (Manual)</td>
              </tr>
              <tr>
                <td class="p-6 font-medium text-slate-900">Enfoque (Focus)</td>
                <td class="p-6 bg-blue-50/50 border-x border-slate-200">Autom√°tico (Motorizado)</td>
                <td class="p-6">Manual (Palanca)</td>
                <td class="p-6">Manual (Bloque)</td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>

      {/* --- SECCI√ìN 3: RESTO DE MARCAS (LISTADO SECUNDARIO) --- */}
      <div class="mb-24">
        <h2 class="text-2xl font-bold text-slate-900 mb-8 pb-2 border-b border-slate-200">Otras Marcas que he Analizado</h2>
        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
          {otherBrands.map((brand) => (
            <a href={`/marcas/${brand.slug}`} class="group bg-white p-6 rounded-xl border border-slate-200 hover:border-blue-400 hover:shadow-md transition-all flex items-center gap-4">
              <img src={brand.logo} alt={brand.name} class="w-16 h-16 object-contain mix-blend-multiply grayscale group-hover:grayscale-0 transition-all" />
              <div>
                <h3 class="font-bold text-slate-900 group-hover:text-blue-600 transition-colors">{brand.name}</h3>
                <div class="flex text-yellow-400 text-xs mb-1">
                   {"‚òÖ".repeat(Math.floor(brand.rating))}
                   <span class="text-slate-200">{"‚òÖ".repeat(5 - Math.floor(brand.rating))}</span>
                </div>
                <span class="text-xs text-slate-500">{brand.pros[0] ? brand.pros[0].slice(0, 30) + '...' : 'Ver an√°lisis'}</span>
              </div>
            </a>
          ))}
        </div>
      </div>

      {/* --- SECCI√ìN 4: FAQ DE EXPERTO --- */}
      <section class="max-w-4xl mx-auto mb-24">
        <h2 class="text-3xl font-bold text-center text-slate-900 mb-12">Preguntas que me hace todo el mundo</h2>
        <div class="space-y-6">
          
          <details class="group bg-white p-6 rounded-2xl shadow-sm border border-slate-200 open:ring-2 open:ring-blue-500/20 transition-all">
            <summary class="flex justify-between items-center font-bold text-lg cursor-pointer list-none text-slate-800">
              ¬øRealmente necesito 20W o 40W? ¬øCon 10W no vale?
              <span class="transition group-open:rotate-180 text-blue-500">
                <svg fill="none" height="24" shape-rendering="geometricPrecision" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" viewBox="0 0 24 24" width="24"><path d="M6 9l6 6 6-6"></path></svg>
              </span>
            </summary>
            <div class="text-slate-600 mt-4 leading-relaxed">
              <p class="mb-2">Depende de si quieres <strong>grabar</strong> o <strong>cortar</strong>:</p>
              <ul class="list-disc pl-5 space-y-1">
                <li><strong>Para grabar:</strong> Con <strong>10W</strong> vas sobrado. De hecho, los m√≥dulos de 10W suelen tener un punto m√°s fino que los de 40W, lo que da m√°s detalle en fotos.</li>
                <li><strong>Para cortar:</strong> Aqu√≠ es donde la potencia manda. Un l√°ser de <strong>10W</strong> corta contrachapado de 3mm en una pasada. Uno de <strong>40W</strong> corta madera de 15-18mm en una pasada. Si quieres hacer cajas, relojes o piezas gruesas, ve a por 20W m√≠nimo.</li>
              </ul>
            </div>
          </details>

          <details class="group bg-white p-6 rounded-2xl shadow-sm border border-slate-200 open:ring-2 open:ring-blue-500/20 transition-all">
            <summary class="flex justify-between items-center font-bold text-lg cursor-pointer list-none text-slate-800">
              ¬øPor qu√© xTool es mucho m√°s cara que Sculpfun?
              <span class="transition group-open:rotate-180 text-blue-500">
                <svg fill="none" height="24" shape-rendering="geometricPrecision" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" viewBox="0 0 24 24" width="24"><path d="M6 9l6 6 6-6"></path></svg>
              </span>
            </summary>
            <div class="text-slate-600 mt-4 leading-relaxed">
              <p>
                Est√°s pagando por la <strong>experiencia de usuario y la seguridad</strong>. Una Sculpfun es un "esqueleto": funciona genial, pero tienes que montarla, ajustar correas, comprar gafas buenas aparte y lidiar con el humo t√∫ mismo. 
                xTool (especialmente la S1 o P2) es un electrodom√©stico cerrado: la sacas de la caja, enchufas y funciona. Tiene carcasa, extracci√≥n de humo, autoenfoque... Pagas tiempo ahorrado y seguridad.
              </p>
            </div>
          </details>

          <details class="group bg-white p-6 rounded-2xl shadow-sm border border-slate-200 open:ring-2 open:ring-blue-500/20 transition-all">
            <summary class="flex justify-between items-center font-bold text-lg cursor-pointer list-none text-slate-800">
              ¬øQu√© es lo primero que debo comprar aparte de la m√°quina?
              <span class="transition group-open:rotate-180 text-blue-500">
                <svg fill="none" height="24" shape-rendering="geometricPrecision" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" viewBox="0 0 24 24" width="24"><path d="M6 9l6 6 6-6"></path></svg>
              </span>
            </summary>
            <div class="text-slate-600 mt-4 leading-relaxed">
              <ol class="list-decimal pl-5 space-y-1">
                <li><strong>Air Assist (Bomba de aire):</strong> Obligatorio si vas a cortar. Sin √©l, la madera se quema y queda negra.</li>
                <li><strong>Base de Panal de Abeja (Honeycomb):</strong> Para que el humo salga por debajo y no manche la parte trasera de la madera.</li>
                <li><strong>Extractor de humo:</strong> Si trabajas en casa, es vital. El humo de cortar MDF o acr√≠lico es t√≥xico.</li>
              </ol>
            </div>
          </details>

        </div>
      </section>

    </div>
  </main>
</Layout>
